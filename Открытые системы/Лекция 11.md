## Детальный обзор systemd
* Более сильный аналог init
* Состоит из скриптов и бинарников
* systemd - это менеджер как ОС, так и ее служб. Запускается сразу после загрузки ядра.
* Комплекс программ systemd можно разбить на 6 групп: (первые две - это бинарники, остальные - именно скрипты в привычном понимании)
	1. systemd
		* systemd - главный запускающий скрипт. Запускается первым
		* namespaces - пространство имен ядра
		* cgroups
		* dbus - отслеживает подключенные устройтсва
	2. login
		* session
		* pam
		* inhibit
		* multiseat
	3. systemd units
		* service - управляет службой/программой
		* target - объединяет набор юнитов для достижения какого-либо целевого состояния ОС
		* mount - скрипт монтирования при запуске. Монтирует все, что должно быть примонтировано в пространство файлов (файловой системе)
		* automount - отвечает за динамическое монтирование (монтирование при первом обращении).
		* socket - отвечает за соединение клиент-сервер. Для сервера должно быть много сокетов, чтоб к нему могли одновременно обращаться много клиентов. Так же управляет локальными IPC (межпроцессными коммуникациями)
		* timer - активирует юниты по таймеру
		* path - активирует службу при изменении объекта файловой системы, находящегося по заданному пути
		* swap - управляет разделом/файлом подкачки
		* device - отражает какое-либо устройство (диск/мышка/клавиатура)
		* slice - объединяет юниты для управления ресурсами
		* scope - управляет службами, запущенными **НЕ** systemd
	4. systemd targets ([[Лекция 10#Уровни выполнения|аналог уровней выполнения]])
		* shutdown
		* reboot
		* basic
		* multi-user
		* graphical
	5. systemd daemons
		* systemd-udevd - демон для работы с устройствами. Отслеживает, какие устройства подключены
		* systemd-journald - демон журналирования
		* systemd-networkd
		* systemd-logind - демон для работы функционала для входа пользователя в систему
	6. systemd utilities
		* systemctl
		* journalctl
		* ... (чуток не успел)

* systemd оперирует юнитами. Они являются скриптами, но в то же время описывают те или иные части ОС
* Информация о юнитах лежит в unit-файлах, где указано: что запустить при запуске юнита, при каких условиях запускать/прерывать, зависимость с другими юнитами итд.
* Имя unit-файла состоит из юнита и суффикса. Например, название `ssh.service` - unit-файл для запуска SSH-службы (`ssh` - имя, `service` - суффикс)
* Юниты бывают системные и пользовательские: системные запускаются от имени root, а пользовательские - от имени пользователя (даже при условии, что пользователь не зареган, пользовательский юнит все равно может запуститься)
* Если активируется target-юнит, то systemd активирует необходимые юниты дополнительно. Например, при подключении принтера его увидит system-udevd, который запустит все необходимые unit'ы

* Каталогов для systemd у нас много: есть 
### Доп. инфа для 7 лабы (установка обновления и удаления прикладного ПО)

* Все делается через пакеты
	* Там есть бинарники исходников и список зависимостей
	* Программный пакет редактирует файлы системы, докидывая различные конфиги, версии библиотек итд.

* Пакет может содержать как одну программу, так и целый комплекс

* В Win тоже есть пакеты, они имеют расширение `.msi`. При установки пакета еще и есть проблема с редактированием реестра.
* С реестрами была проблема - как их чистить при удалении ПО. Потому что там не указывалось, какая программа что использовала, поэтому при удалении могло что-то сломать для других программ.
* Решили это новым расширением `.msix`. В нем лежит абсолютно все
* Вот в UNIX эта идея есть в пакетах. Пакеты бывают двух видов: `.deb` (для Debian-систем) и `.rpm` (для RedHat-систем)
	* Для `.rpm` используется менеджер `rpm`
	* Для `.deb` используется менеджер `dpkg`
	* Пакет может ссылаться на библиотеки, которые в нем самом может и не быть. Поэтому какие-то программы могут ломать друг друга. Для решения этой проблемы решили пихать программы в контейнеры, чтоб они работали независимо.
	* Менеджеры пакетов требовали много различных команд и параметров. Поэтому решили их усилить. В `.rpm` таким расширенным менеджером стал `yum`, а в `.deb` - `apt` (advanced packet manager).
	* Пакеты лежат в репозиториях, причем для каждого дистрибутива есть свой репозиторий, где лежат бинарники/исходники.

# 